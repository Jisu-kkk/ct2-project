{% extends "/admin/layout/layout" %}

{% block body %}
<div class="content" id="content">
  <div class="content-header">
    <div class="title">
      <h2>ë³¸ë¶€ì†Œê°œ</h2>
      <button class="ui button primary right floated">ìˆœì„œ ì €ì¥</button>
    </div>
  </div>
  <div class="card-layout intro-layout">
    <div class="card col-12">
      <div class="card-inner">
        <div class="card-body">
          <div class="ui innerContent cardContainer">
          {% for intro in introList %}
            {% if loop.length == 0 %}
            <h4>ì‘ì„±ëœ ë³¸ë¶€ì†Œê°œê°€ ì—†ìŠµë‹ˆë‹¤. ë³¸ë¶€ì†Œê°œë¥¼ ë“±ë¡í•´ ì£¼ì„¸ìš”<span>ğŸ¤—</span></h4>
            {% else %}
            <div id="{{ intro.id }}" class="card-body draggable" draggable="true" title="ì»¨í…ì¸ ë¥¼ ë“œë˜ê·¸í•˜ì—¬ ìœ„/ì•„ë˜ë¡œ ìˆœì„œë³€ê²½ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.">
              <div class="intro-wrap">
                <div class="intro-con">
                  <div class="ui middle aligned stackable grid container">
                    <div class="row">
                      {% if intro.location == 0 %}
                      <div class="six wide left floated column img-wrapp">
                        <img class="ui left floated large bordered rounded image" src="../semantic/themes/default/assets/images/ct2-intro-crop-image-{{ intro.id }}.png">
                        <!--<img class="ui left floated large bordered rounded image" src="https://www.emotion.co.kr/pc/img/02_img_02.cd3f8a5d.webp">-->
                        <!--<img class="ui left floated large bordered rounded image" src="/images/{{ intro.fileName }}">-->
                      </div>
                      <div class="nine wide column">
                        <a class="ui header" href="/admin/editIntro">
                          <h3 class="ui header">{{ intro.title }}</h3>
                        </a>
                        <p>{{ intro.content }}</p>
                      </div>
                      {% else %}
                      <div class="nine wide column">
                        <a class="ui header" href="/admin/editIntro">
                          <h3 class="ui header">{{ intro.title }}</h3>
                        </a>
                        <p>{{ intro.content }}</p>
                      </div>
                      <div class="six wide right floated column img-wrapp">
                        <img class="ui right floated large bordered rounded image" src="../semantic/themes/default/assets/images/ct2-intro-crop-image-{{ intro.id }}.png">
                        <!--<img class="ui right floated large bordered rounded image" src="https://www.emotion.co.kr/pc/img/02_img_03.d71a6f53.webp">-->
                        <!--<img class="ui right floated large bordered rounded image" src="/images/{{ intro.fileName }}">-->
                      </div>
                      {% endif %}
                    </div>
                  </div>
                </div>
              </div>
            </div>
            {% endif %}
          {% endfor %}

            <!--Contents[S]-->
            <!--<div class="card-body draggable" draggable="true" title="ì»¨í…ì¸ ë¥¼ ë“œë˜ê·¸í•˜ì—¬ ìœ„/ì•„ë˜ë¡œ ìˆœì„œë³€ê²½ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.">
              <div class="intro-wrap">
                <div class="intro-con">
                  <div class="ui middle aligned stackable grid container">
                    <div class="row">
                      <div class="six wide left floated column img-wrapp">
                        <img class="ui left floated large bordered rounded image" src="https://www.emotion.co.kr/pc/img/02_img_02.cd3f8a5d.webp">
                      </div>
                      <div class="nine wide column">
                        <a class="ui header" href="/admin/editIntro">
                          <h3 class="ui header">ìš°ë¦¬ëŠ” ì‚¬ëŒì„ í–¥í•œ ë”°ëœ»í•œ ê°ì„±ê³¼ ì´ì„±ì  ì‚¬ê³ ë¥¼ ê²¸ë¹„í•œ ë””ì§€í„¸ ì „ë¬¸ê°€ ì§‘ë‹¨ì…ë‹ˆë‹¤.</h3>
                        </a>
                        <p>ë‹¤ì–‘í•œ ì‹¤ì „ ê²½í—˜ê³¼ ì§€ì‹ì„ ê°–ì¶˜ ì „ë¬¸ê°€ë“¤ì´ ë‹¹ì‹ ì˜ ì‚¬ì—… íŒŒíŠ¸ë„ˆê°€ ë˜ì–´ ë†’ì€ ìˆ˜ì¤€ì˜ êµ¬ì¶•ê³¼ ì•ˆì •ì ì¸ ìš´ì˜ ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•©ë‹ˆë‹¤.</p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="card-body draggable" draggable="true" title="ì»¨í…ì¸ ë¥¼ ë“œë˜ê·¸í•˜ì—¬ ìœ„/ì•„ë˜ë¡œ ìˆœì„œë³€ê²½ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.">
              <div class="intro-wrap">
                <div class="intro-con">
                  <div class="ui middle aligned stackable grid container">
                    <div class="row">
                      <div class="nine wide column">
                        <a class="ui header" href="/admin/editIntro">
                          <h3 class="ui header">ì‚¬ê³ ì˜ í­ê³¼ ê¹Šì´ë¥¼ í™•ì¥ì‹œí‚¤ëŠ” ìˆ˜í‰ì ì´ê³  ììœ ë¡œìš´ ë¶„ìœ„ê¸° ì†ì—ì„œ í•¨ê»˜ ì„±ì¥í•©ë‹ˆë‹¤.</h3>
                        </a>
                        <p>ìš°ë¦¬ëŠ” ê°ìì˜ ê°œì„±ê³¼ ê´€ì ì„ ì¡´ì¤‘í•˜ê³  ì„œë¡œ ë‹¤ë¦„ì„ ì´í•´í•˜ë©° ê³µë™ì˜ ëª©í‘œë¥¼ í–¥í•´ ë‚˜ì•„ê°‘ë‹ˆë‹¤. ë™ë£Œë¥¼ í–¥í•œ ì‹ ë¢°ëŠ” ìœ ì—°í•œ íŒ€ ë¬¸í™”ë¥¼ ë§Œë“¤ê³  ê·¸ ì†ì—ì„œ ëª°ì…ì„ í†µí•œ í­ë°œì ì¸ ì„±ì¥ì„ ê²½í—˜í•˜ê²Œ ë©ë‹ˆë‹¤.</p>
                      </div>
                      <div class="six wide right floated column img-wrapp">
                        <img class="ui right floated large bordered rounded image" src="https://www.emotion.co.kr/pc/img/02_img_03.d71a6f53.webp">
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>-->
            <!--Contents[E]-->
          </div>
          <!-- ë²„íŠ¼ -->
          <div class="ui right aligned header">
            <a href="/admin/addIntro" class="ui button primary">ë“±ë¡</a>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block script %}
<script type="text/javascript">
/* file[S] */
$(document).ready(function () {
  $('input[type=file]').on('change', function(e){
    fileCheck(e);
  });
});

function fileCheck(e) {
  var target = e.target;
  var file = target.files[0].name;
  var html = '<label>' + file + '</label>';
  html += '<button class="delete" onclick="fileDelete(this);">';
  html += '<i class="icon close"></i>';
  html += '</button>';
  $(target).closest('div').find('span').html(html);
}

function fileDelete(e) {
  var parentEl = e.closest('.card-body');
  $(parentEl).find('span').empty();
  $(parentEl).find($('input[type=file]')).val("");
}
/* file[E] */

/* Drag & Drop[S] */
const draggables = document.querySelectorAll(".draggable");
const containers = document.querySelectorAll(".cardContainer");

draggables.forEach(draggable => {
  draggable.addEventListener("dragstart", () => {
    draggable.classList.add("dragging");
  });

  draggable.addEventListener("dragend", () => {
    draggable.classList.remove("dragging");
  });
});

containers.forEach(container => {
  container.addEventListener("dragover", e => {
    e.preventDefault();
    const afterElement = getDragAfterElement(container, e.clientY);
    const draggable = document.querySelector(".dragging");
    if (afterElement === undefined) {
      container.appendChild(draggable);
    } else {
      container.insertBefore(draggable, afterElement);
    }
  });
});

function getDragAfterElement(container, y) {
  const draggableElements = [
    ...container.querySelectorAll(".draggable:not(.dragging)"),
  ];

  return draggableElements.reduce(
    (closest, child) => {
      const box = child.getBoundingClientRect();
      const offset = y - box.top - box.height/2;
      // console.log(offset);
      if (offset < 0 && offset > closest.offset) {
        return { offset: offset, element: child };
      } else {
        return closest;
      }
    },
    { offset: Number.NEGATIVE_INFINITY },
  ).element;
}
/* Drag & Drop[E] */
</script>
{% endblock %}